# arkai Repository Structure

> **As of**: 2026-01-21
> **Purpose**: Comprehensive repo tree for Chad and external collaborators
> **Note**: This snapshot will become outdated as the repo evolves. Regenerate as needed.

---

## Quick Stats

- **Language**: Rust (core), Python (scripts/sidecars)
- **Architecture**: Event-sourced orchestration engine
- **Key Integrations**: Fabric patterns, Obsidian vault, RLM (recursive LLM)
- **Session Systems**: RALPH (reflection), Steelman (multi-model consensus)

---

## Repository Tree

```
arkai/
â”‚
â”œâ”€â”€ ğŸ“¦ ROOT CONFIGURATION
â”‚   â”œâ”€â”€ Cargo.toml                    # Rust manifest - event-sourced orchestrator
â”‚   â”œâ”€â”€ Cargo.lock                    # Dependency lock
â”‚   â”œâ”€â”€ README.md                     # Main docs with architecture diagrams
â”‚   â”œâ”€â”€ LICENSE                       # MIT
â”‚   â”œâ”€â”€ TODO.md                       # Feature backlog
â”‚   â”œâ”€â”€ run_log.md                    # Session activity log
â”‚   â””â”€â”€ .gitignore
â”‚
â”œâ”€â”€ .claude/                          # Claude Code project context
â”‚   â”œâ”€â”€ README.md                     # Local context documentation
â”‚   â”œâ”€â”€ .gitignore
â”‚   â””â”€â”€ settings.local.json           # Project-specific settings
â”‚
â”œâ”€â”€ .arkai/                           # Runtime configuration
â”‚   â””â”€â”€ config.yaml                   # Pipeline runtime config
â”‚
â”œâ”€â”€ .ralph/                           # ğŸ§  RALPH session memory system
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â”œâ”€â”€ constraints.md            # Hard rules & safety rails
â”‚   â”‚   â”œâ”€â”€ decisions.log             # Append-only decision history
â”‚   â”‚   â””â”€â”€ rolling_summary.md        # Compressed context
â”‚   â”œâ”€â”€ runs/                         # Session archives (timestamped)
â”‚   â””â”€â”€ templates/
â”‚       â”œâ”€â”€ bootstrap.md              # Session start prompt
â”‚       â””â”€â”€ distill_prompt.md         # End-of-session artifact generation
â”‚
â”œâ”€â”€ .steelman/                        # ğŸ¤– Multi-model consensus system
â”‚   â”œâ”€â”€ consensus_log.md              # Debate history
â”‚   â””â”€â”€ sessions/
â”‚       â””â”€â”€ 9e4fca9a/                 # Example session
â”‚           â”œâ”€â”€ state.json
â”‚           â”œâ”€â”€ CONSENSUS.md          # Final decision
â”‚           â””â”€â”€ debate_transcript.md  # Model-vs-model dialogue
â”‚
â”œâ”€â”€ src/                              # ğŸ¦€ RUST SOURCE CODE
â”‚   â”œâ”€â”€ main.rs                       # CLI entry point
â”‚   â”œâ”€â”€ lib.rs                        # Library root
â”‚   â”œâ”€â”€ config.rs                     # Configuration parsing
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/                     # External integrations
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â””â”€â”€ fabric.rs                 # Fabric pattern adapter
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                          # Command-line interface
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â””â”€â”€ evidence.rs               # Provenance tracking CLI
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                         # âš™ï¸ CORE ENGINE
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ event_store.rs            # Append-only event log
â”‚   â”‚   â”œâ”€â”€ orchestrator.rs           # Pipeline coordination
â”‚   â”‚   â”œâ”€â”€ pipeline.rs               # Step execution
â”‚   â”‚   â””â”€â”€ safety.rs                 # Limits & constraints
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                       # Domain models
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ events.rs                 # Event types
â”‚   â”‚   â”œâ”€â”€ run.rs                    # Run state machine
â”‚   â”‚   â””â”€â”€ artifact.rs               # Content artifacts
â”‚   â”‚
â”‚   â”œâ”€â”€ evidence/                     # Audit trail
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ types.rs                  # Evidence types
â”‚   â”‚   â””â”€â”€ spans.rs                  # Trace spans
â”‚   â”‚
â”‚   â””â”€â”€ library/                      # Content management
â”‚       â”œâ”€â”€ mod.rs
â”‚       â”œâ”€â”€ catalog.rs                # Searchable index
â”‚       â””â”€â”€ content.rs                # Storage/retrieval
â”‚
â”œâ”€â”€ tests/                            # Integration tests
â”‚   â”œâ”€â”€ event_store.rs                # Event correctness
â”‚   â”œâ”€â”€ idempotency.rs                # Resume behavior
â”‚   â”œâ”€â”€ safety.rs                     # Limit enforcement
â”‚   â””â”€â”€ timeout.rs                    # Resilience
â”‚
â”œâ”€â”€ pipelines/                        # ğŸ“‹ YAML PIPELINE DEFINITIONS
â”‚   â”œâ”€â”€ hello.yaml                    # Simple test pipeline
â”‚   â”œâ”€â”€ web-wisdom.yaml               # Web content â†’ wisdom
â”‚   â””â”€â”€ youtube-wisdom.yaml           # YouTube â†’ transcript â†’ wisdom
â”‚
â”œâ”€â”€ docs/                             # ğŸ“š DESIGN DOCUMENTATION
â”‚   â”œâ”€â”€ AI_OS_ARCHITECTURE.md         # Full AI OS philosophy
â”‚   â”œâ”€â”€ AIOS_BRIEF.md                 # Executive summary
â”‚   â”œâ”€â”€ PITCH.md                      # Value proposition
â”‚   â”œâ”€â”€ ROADMAP.md                    # Feature roadmap
â”‚   â”œâ”€â”€ RLM_INTEGRATION.md            # Recursive LLM design
â”‚   â”œâ”€â”€ RALPH_DESIGN.md               # RALPH system design
â”‚   â”œâ”€â”€ ARKAI_GMAIL_DESIGN.md         # Gmail triage integration (~2200 lines)
â”‚   â”œâ”€â”€ ARKAI_VOICE_CAPTURE_DESIGN.md # Voice â†’ Obsidian pipeline (~800 lines)
â”‚   â””â”€â”€ LINKEDIN_PITCHES.md           # Marketing variants
â”‚
â”œâ”€â”€ ai_docs/                          # AI-generated documentation
â”‚   â””â”€â”€ architecture/
â”‚       â””â”€â”€ overview.md               # Technical deep-dive
â”‚
â”œâ”€â”€ scripts/                          # ğŸ”§ UTILITIES
â”‚   â”œâ”€â”€ ralph                         # RALPH CLI (Python)
â”‚   â”œâ”€â”€ render_transcript.py          # Consensus transcript renderer
â”‚   â”œâ”€â”€ rlm_smoke_test_a.md           # RLM test case A
â”‚   â””â”€â”€ rlm_smoke_test_b.md           # RLM test case B
â”‚
â”œâ”€â”€ patterns/                         # ğŸ¯ FABRIC PATTERNS
â”‚   â”œâ”€â”€ extract_claims/
â”‚   â”‚   â””â”€â”€ system.md                 # Claims extraction prompt
â”‚   â””â”€â”€ extract_entities/
â”‚       â””â”€â”€ system.md                 # NER extraction prompt
â”‚
â”œâ”€â”€ scout_outputs/                    # ğŸ” RESEARCH & ANALYSIS
â”‚   â”œâ”€â”€ ARCHITECTURE_CLARITY.md
â”‚   â”œâ”€â”€ FABRIC_LLM_EXPLAINED.md
â”‚   â”œâ”€â”€ STORAGE_ARCHITECTURE.md
â”‚   â”œâ”€â”€ SESSION_SUMMARY.md            # Session 1
â”‚   â”œâ”€â”€ SESSION_2_SUMMARY.md
â”‚   â”œâ”€â”€ SESSION_3_SUMMARY.md
â”‚   â”œâ”€â”€ SESSION_4_SUMMARY.md
â”‚   â”œâ”€â”€ SESSION_5_SUMMARY.md
â”‚   â”œâ”€â”€ SESSION_6_RLM_INTEGRATION.md
â”‚   â”œâ”€â”€ REPO_TREE_2026-01-21.md       # THIS FILE
â”‚   â”‚
â”‚   â””â”€â”€ research/
â”‚       â”œâ”€â”€ README.md
â”‚       â”œâ”€â”€ SCHEMA_SPEC.md
â”‚       â”œâ”€â”€ SYNTHESIS.md
â”‚       â”‚
â”‚       â”œâ”€â”€ diarization/              # Voice diarization research
â”‚       â”‚   â”œâ”€â”€ assemblyai.md
â”‚       â”‚   â””â”€â”€ whisperx.md
â”‚       â”‚
â”‚       â”œâ”€â”€ frontend/
â”‚       â”‚   â””â”€â”€ OPTIONS.md            # Frontend tech analysis
â”‚       â”‚
â”‚       â”œâ”€â”€ keyframes/
â”‚       â”‚   â””â”€â”€ video-ops.md          # Video analysis
â”‚       â”‚
â”‚       â””â”€â”€ obsidian-reorg/           # Vault reorganization
â”‚           â”œâ”€â”€ ROADMAP.md
â”‚           â”œâ”€â”€ SCORING_RUBRIC.md
â”‚           â”œâ”€â”€ STRATEGY_FINAL_v2.md
â”‚           â”œâ”€â”€ rubric-consensus.md
â”‚           â”œâ”€â”€ ADHD_NOTE_SYSTEM_RESEARCH.md
â”‚           â””â”€â”€ obsidian-olek-vault/  # Reference vault snapshot
â”‚               â”œâ”€â”€ Templates/
â”‚               â”œâ”€â”€ 01-Daily/
â”‚               â”œâ”€â”€ 02-Work/
â”‚               â””â”€â”€ .obsidian/
â”‚
â”œâ”€â”€ vault-sandbox/                    # ğŸ““ LIVE OBSIDIAN VAULT
â”‚   â”œâ”€â”€ ! HOME BASE.md                # Vault home
â”‚   â”œâ”€â”€ Today.md
â”‚   â”œâ”€â”€ 00-Inbox/                     # Capture inbox
â”‚   â”œâ”€â”€ 10-Active/                    # Active projects
â”‚   â”œâ”€â”€ 20-Reference/                 # Reference materials
â”‚   â”œâ”€â”€ 90-Archive/                   # Archived items
â”‚   â”œâ”€â”€ 99-Private/                   # Private (AI-excluded)
â”‚   â”œâ”€â”€ LEARNING/
â”‚   â”‚   â””â”€â”€ ANKI DECKS/
â”‚   â”œâ”€â”€ .obsidian/                    # Obsidian config + plugins
â”‚   â”œâ”€â”€ .ralph/                       # Vault-specific RALPH
â”‚   â”œâ”€â”€ .space/                       # Space.so integration
â”‚   â””â”€â”€ .aiexclude                    # AI indexing exclusions
â”‚
â”œâ”€â”€ assets/                           # Brand assets
â”‚   â””â”€â”€ asset_gen_prompts/
â”‚       â””â”€â”€ banner_prompts.txt
â”‚
â”œâ”€â”€ specs/                            # Specifications (empty)
â”‚
â”œâ”€â”€ target/                           # [GITIGNORED] Rust build artifacts
â””â”€â”€ logs/                             # [GITIGNORED] Application logs
```

---

## Directory Purposes

| Directory | Purpose |
|-----------|---------|
| `src/` | Rust core: event store, pipeline orchestration, safety |
| `docs/` | Architecture designs, roadmaps, integration specs |
| `scout_outputs/` | Research findings, session summaries, analysis |
| `patterns/` | Fabric-compatible AI prompts |
| `pipelines/` | Reusable YAML workflow definitions |
| `tests/` | Integration tests for core functionality |
| `.ralph/` | Session memory system (bootstrap, distill, memory) |
| `.steelman/` | Multi-model consensus debates |
| `vault-sandbox/` | Live Obsidian knowledge vault |
| `scripts/` | Python utilities, RALPH CLI |

---

## Key Design Documents (for Chad)

| Document | Lines | Purpose |
|----------|-------|---------|
| `docs/AI_OS_ARCHITECTURE.md` | ~500 | Full philosophy & design |
| `docs/ARKAI_GMAIL_DESIGN.md` | ~2200 | Gmail triage integration (7-layer security) |
| `docs/ARKAI_VOICE_CAPTURE_DESIGN.md` | ~800 | Voice Memo â†’ Obsidian pipeline |
| `docs/RLM_INTEGRATION.md` | ~300 | Recursive LLM for massive context |
| `docs/RALPH_DESIGN.md` | ~400 | Session memory architecture |

---

## Core Concepts

### Event Sourcing
All state changes are recorded as immutable events. Enables:
- Full audit trail
- Idempotent resume from failure
- Time-travel debugging

### Pipeline Architecture
```
Input â†’ [Step 1] â†’ [Step 2] â†’ ... â†’ [Step N] â†’ Artifacts
              â†“           â†“
         EventStore (records everything)
```

### Safety Limits
- Max steps per run
- Timeout per step
- Token limits
- Retry policies

### RALPH Session Memory
```
ralph run "task"  â†’  Creates session, injects bootstrap
ralph close       â†’  Captures diff, prompts distillation
ralph finalize    â†’  Archives session, updates memory
ralph resume      â†’  Prints next_prompt from last session
```

### Trust Tiers (for integrations)
- **Tier 0**: Read-only, transcript only
- **Tier 1**: LLM suggestions written to notes (no external effects)
- **Tier 2**: External actions after manual review
- **Tier 3**: Limited auto-apply for whitelisted actions

---

## Upcoming Integrations

| Feature | Status | Design Doc |
|---------|--------|------------|
| Gmail Triage | Designed | `ARKAI_GMAIL_DESIGN.md` |
| Voice Capture | Designed | `ARKAI_VOICE_CAPTURE_DESIGN.md` |
| Obsidian Reorg | In Progress | `research/obsidian-reorg/` |
| RLM Integration | Integrated | `RLM_INTEGRATION.md` |

---

## For Chad: Quick Reference

**To understand the core engine:**
```
src/core/event_store.rs  â†’ How events are stored
src/core/pipeline.rs     â†’ How pipelines execute
src/core/safety.rs       â†’ How limits are enforced
```

**To understand integrations:**
```
docs/ARKAI_GMAIL_DESIGN.md         â†’ Gmail triage (Python sidecar)
docs/ARKAI_VOICE_CAPTURE_DESIGN.md â†’ Voice capture (native Rust)
```

**To understand session management:**
```
.ralph/templates/bootstrap.md      â†’ How sessions start
.ralph/templates/distill_prompt.md â†’ How sessions end
scripts/ralph                      â†’ CLI implementation
```

---

*Generated: 2026-01-21 by Claude Opus 4.5*
*Regenerate this file when the repo structure changes significantly.*
